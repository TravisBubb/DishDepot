@page "/register"

@using BSS.DishDepot.Application.Dto

@inject ApiClient ApiClient
@inject NavigationManager NavigationManager

<h3>Register</h3>
<EditForm class="new-blog-form" Model="@registerRequest.User" OnValidSubmit="HandleValidSubmit">
    <div class="form-group row">
        <label for="email" class="col-sm-2 col-form-label">E Mail</label>
        <div class="col-sm-10">
            <input type="email" @bind="registerRequest.User.Email" class=" form-control" id="email" placeholder="Email">
        </div>
    </div>
    <div class="form-group row">
        <label for="password" class="col-sm-2 col-form-label">Password</label>
        <div class="col-sm-10">
            <input type="password" @bind="registerRequest.User.Password" class="form-control" id="password"
                   placeholder="Password">
        </div>
    </div>
    <div class="form-group row">
        <div class="col-sm-10">
            <button type="submit" class="btn btn-primary">Register</button>
        </div>
    </div>
</EditForm>

@code {
    private PostUserRequest registerRequest = new PostUserRequest { User = new PostUser() };

    private async void HandleValidSubmit()
    {
        var result = await ApiClient.RegisterUser(registerRequest);
        if (!result.IsSuccessful)
        {
            return;
        }

        NavigationManager.NavigateTo("/login");
    }
}